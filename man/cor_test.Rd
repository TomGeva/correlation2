% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cor_test.R
\name{cor_test}
\alias{cor_test}
\title{Correlation test}
\usage{
cor_test(
  x,
  y,
  data = NULL,
  method = "pearson",
  ci = 0.95,
  alternative = "two.sided",
  bayesian = FALSE,
  verbose = TRUE,
  ...
)
}
\arguments{
\item{x, y}{Vectors of the two variables the correlation test is done for.
\cr Alternatively, can be names of variables in \code{data}.}

\item{data}{An optional data frame.}

\item{method}{A character string indicating which correlation coefficient is
to be used for the test. \cr Possible Values: \code{"pearson"} (default),
\code{"kendall"}, \code{"spearman"}, \code{"biserial"}, \code{"point-biserial"}, \code{"rankbiserial"},
\code{"polychoric"}, \code{"tetrachoric"}, \code{"biweight"}, \code{"distance"}, \code{"percentage"}
(for percentage bend correlation), \code{"blomqvist"} (for Blomqvist's
coefficient), \code{"hoeffding"} (for Hoeffding's D), \code{"gamma"}, \code{"gaussian"}
(for Gaussian Rank correlation), \code{"shepherd"} (for Shepherd's Pi correlation).
\cr (polychoric when ordinal factors involved, tetrachoric when dichotomous
factors involved, point-biserial if one dichotomous and one continuous and
pearson otherwise). See below the \strong{details} section for a description of
these indices.}

\item{ci}{Confidence/Credible Interval level. If \code{"default"}, then it is
set to \code{0.95} (\verb{95\%} CI).}

\item{bayesian}{If \code{TRUE}, will run the correlations under a Bayesian
framework.}

\item{verbose}{Toggle warnings.}

\item{...}{Optional arguments:
\itemize{
\item \code{data} A data frame (when \code{x} and/or \code{y} are not vectors).
\item Arguments dependent on \code{method} being:
\itemize{
\item \code{"kendall"}:
\itemize{
\item \code{tau_type} = \code{"b"}
\item \code{direction} = \code{"row"} (used when \code{tau_type} = \code{"a"})
}
\item \code{"distance"}:
\itemize{
\item \code{corrected} = \code{TRUE}
}
\item \code{"percentage"}:
\itemize{
\item \code{beta} = \code{0.2}
}
\item \code{"bayes"}:
\itemize{
\item \code{bayesian_prior} = "medium"
\item \code{bayesian_ci_method} = "hdi"
\item \code{bayesian_test} = \code{c("pd", "rope", "bf")}
}
}
}}
}
\description{
This function performs a correlation test between two variables.
You can easily visualize the result using \code{\link[=visualisation_recipe.easycormatrix]{plot()}} (see examples \href{https://easystats.github.io/correlation/reference/visualisation_recipe.easycormatrix.html#ref-examples}{\strong{here}}).
}
\details{
\subsection{Correlation Types}{
\itemize{
\item \strong{Pearson's correlation}: This is the most common correlation method. It
corresponds to the covariance of the two variables normalized (i.e., divided)
by the product of their standard deviations.
\item \strong{Spearman's rank correlation}: A non-parametric measure of rank
correlation (statistical dependence between the rankings of two variables).
\cr The Spearman correlation between two variables is equal to the Pearson
correlation between the rank values of those two variables; while Pearson's
correlation assesses linear relationships, Spearman's correlation assesses
monotonic relationships (whether linear or not). \cr Confidence Intervals
(CI) for Spearman's correlations are computed using the Fieller et al. (1957)
correction (see Bishara and Hittner, 2017).
\item \strong{Kendall's rank correlation}: Is used to quantify the association between
two variables based on the ranks of their data points. \cr It comes in three
variants which provide different approaches for handling tied ranks, allowing
for robust assessments of association across different datasets and
scenarios. \cr Confidence Intervals (CI) for Kendall's correlations are
computed using the Fieller et al. (1957) correction (see Bishara and Hittner,
2017). \cr The three variants are: tau-a, tau-b (default), and tau-c.
\itemize{
\item \strong{Tau-a} doesn't account for ties and calculates the difference between
the proportions of concordant and discordant pairs.
\item \strong{Tau-b} adjusts for ties by incorporating a correction factor, ensuring
a more accurate measure of association.
\item \strong{Tau-c}, similar to tau-b, considers ties, but it only adjusts for
pairs where both variables have tied ranks.
}
\item \strong{Biweight midcorrelation}: A measure of similarity that is
median-based, instead of the traditional mean-based, thus being less
sensitive to outliers. \cr It can be used as a robust alternative to other
similarity metrics, such as Pearson correlation (Langfelder & Horvath,
2012).
\item \strong{Distance correlation}: Distance correlation measures both
linear and non-linear association between two random variables or random
vectors. \cr This is in contrast to Pearson's correlation, which can only detect
linear association between two random variables.
\item \strong{Percentage bend correlation}: Introduced by Wilcox (1994), it
is based on a down-weight of a specified percentage of marginal observations
deviating from the median (by default, \verb{20\%}).
\item \strong{Shepherd's Pi correlation}: Equivalent to a Spearman's rank
correlation after outliers removal (by means of bootstrapped Mahalanobis
distance).
\item \strong{Blomqvist’s coefficient}: The Blomqvist’s coefficient (also
referred to as Blomqvist's Beta or medial correlation; Blomqvist, 1950) is a
median-based non-parametric correlation that has some advantages over
measures such as Spearman's or Kendall's estimates (see Shmid & Schimdt,
2006).
\item \strong{Hoeffding’s D}: The Hoeffding’s D statistics is a non-parametric rank
based measure of association that detects more general departures from
independence (Hoeffding 1948), including non-linear associations. \cr
Hoeffding’s D varies between -0.5 and 1 (if there are no tied ranks,
otherwise it can have lower values), with larger values indicating a stronger
relationship between the variables.
\item \strong{Somers’ D}: The Somers’ D statistics is a non-parametric rank
based measure of association between a binary variable and a continuous
variable, for instance, in the context of logistic regression the binary
outcome and the predicted probabilities for each outcome. \cr Usually,
Somers' D is a measure of ordinal association, however, this implementation
it is limited to the case of a binary outcome.
\item \strong{Point-Biserial, Rank-Biserial and biserial correlation}: Correlation
coefficient used when one variable is continuous and the other is dichotomous
(binary). \cr Point-Biserial is equivalent to a Pearson's correlation, while
Biserial should be used when the binary variable is assumed to have an
underlying continuity. For example, anxiety level can be measured on a
continuous scale, but can be classified dichotomously as high/low. \cr
Rank-Biserial is also equivalent to a Pearson's correlation, but it is used
when the continuous variable is ordinal, and the dichotomous variable is
assumed to have any relation to the order of the ordinal variable rather than
it's value.
\item \strong{Gamma correlation}: The Goodman-Kruskal gamma statistic is similar to
Kendall's Tau coefficient. It is relatively robust to outliers and deals well
with data that have many ties.
\item \strong{Gaussian rank Correlation}: The Gaussian rank correlation estimator is a
simple and well-performing alternative for robust rank correlations (Boudt et
al., 2012). \cr It is based on the Gaussian quantiles of the ranks.
\item \strong{Polychoric correlation}: Correlation between two theorized normally
distributed continuous latent variables, from two observed ordinal variables.
\item \strong{Tetrachoric correlation}: Special case of the polychoric correlation
applicable when both observed variables are dichotomous.
}
}
}
\examples{
library(correlation)

cor_test(iris, "Sepal.Length", "Sepal.Width")
cor_test(iris, "Sepal.Length", "Sepal.Width", method = "spearman")
\donttest{
cor_test(iris, "Sepal.Length", "Sepal.Width", method = "kendall")
cor_test(iris, "Sepal.Length", "Sepal.Width", method = "biweight")
cor_test(iris, "Sepal.Length", "Sepal.Width", method = "distance")
cor_test(iris, "Sepal.Length", "Sepal.Width", method = "percentage")

if (require("wdm", quietly = TRUE)) {
  cor_test(iris, "Sepal.Length", "Sepal.Width", method = "blomqvist")
}

if (require("Hmisc", quietly = TRUE)) {
  cor_test(iris, "Sepal.Length", "Sepal.Width", method = "hoeffding")
}
cor_test(iris, "Sepal.Length", "Sepal.Width", method = "gamma")
cor_test(iris, "Sepal.Length", "Sepal.Width", method = "gaussian")
cor_test(iris, "Sepal.Length", "Sepal.Width", method = "shepherd")
if (require("BayesFactor", quietly = TRUE)) {
  cor_test(iris, "Sepal.Length", "Sepal.Width", bayesian = TRUE)
}

# Robust (these two are equivalent)
cor_test(iris, "Sepal.Length", "Sepal.Width", method = "spearman")
cor_test(iris, "Sepal.Length", "Sepal.Width", method = "pearson", ranktransform = TRUE)

# Winsorized
cor_test(iris, "Sepal.Length", "Sepal.Width", winsorize = 0.2)

# Tetrachoric
if (require("psych", quietly = TRUE) && require("rstanarm", quietly = TRUE)) {
  data <- iris
  data$Sepal.Width_binary <- ifelse(data$Sepal.Width > 3, 1, 0)
  data$Petal.Width_binary <- ifelse(data$Petal.Width > 1.2, 1, 0)
  cor_test(data, "Sepal.Width_binary", "Petal.Width_binary", method = "tetrachoric")

  # Biserial
  cor_test(data, "Sepal.Width", "Petal.Width_binary", method = "biserial")

  # Polychoric
  data$Petal.Width_ordinal <- as.factor(round(data$Petal.Width))
  data$Sepal.Length_ordinal <- as.factor(round(data$Sepal.Length))
  cor_test(data, "Petal.Width_ordinal", "Sepal.Length_ordinal", method = "polychoric")

  # When one variable is continuous, will run 'polyserial' correlation
  cor_test(data, "Sepal.Width", "Sepal.Length_ordinal", method = "polychoric")
}

# Partial
cor_test(iris, "Sepal.Length", "Sepal.Width", partial = TRUE)
cor_test(iris, "Sepal.Length", "Sepal.Width", multilevel = TRUE)
cor_test(iris, "Sepal.Length", "Sepal.Width", partial_bayesian = TRUE)
}
}
